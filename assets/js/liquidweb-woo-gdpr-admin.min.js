function clearNewFieldInputs(){jQuery(".lw-woo-gdpr-new-fields-row #lw-woo-gdpr-new-title").val(""),jQuery(".lw-woo-gdpr-new-fields-row #lw-woo-gdpr-new-label").val(""),jQuery(".lw-woo-gdpr-new-fields-row #lw-woo-gdpr-new-required").prop("checked",!1)}function resetTableCount(e){jQuery("div.tablenav").each(function(){jQuery(this).find("span.displaying-num").text(e)})}function setAdminNotification(e,t,o){t=t||"updated",o=o||".lw-woo-gdpr-requests-admin-wrap";var r="";r+='<div id="message" class="'+t+' settings-error notice is-dismissible lw-woo-request-notice">',r+="<p>"+e+"</p>",r+='<button type="button" class="notice-dismiss"><span class="screen-reader-text">'+adminLWWooGDPR.dismiss_text+"</span></button>",r+="</div>",jQuery(o+" h1:first").after(r)}function clearBulkChecks(){jQuery("input.lw-woo-user-checkbox:checked").map(function(){jQuery(this).parents("tr").fadeOut().remove()}),jQuery("table.userdeletionrequests td.check-column").find("input[type=checkbox]").prop("checked",!1),jQuery("#bulk-action-selector-top").val("-1"),jQuery("#bulk-action-selector-bottom").val("-1")}jQuery(document).ready(function(e){e.fn.divExists=function(e){var t=[].slice.call(arguments,1);return this.length&&e.call(this,t),this};var t,o="form#mainform",r="table.lw-woo-gdpr-saved-table-wrap",n="table.lw-woo-gdpr-saved-table-wrap tbody",a="table.userdeletionrequests",i=[],s="";e(r).divExists(function(){e(n).sortable({handle:".lw-woo-gdpr-trigger-icon",update:function(t,o){var r={action:"lw_woo_update_sorted_rows",sorted:e(n).sortable("toArray",{attribute:"data-key"})};jQuery.post(ajaxurl,r)}})}),e(o).on("click","button",function(){t=!!e(this).hasClass("lw-woo-gdpr-add-new")}),e(o).submit(function(o){if(!0===t){if(o.preventDefault(),e(".woo-nav-tab-wrapper a").off(),newNonce=e("input#lw_woo_gdpr_new_nonce").val(),""===newNonce||void 0===newNonce)return!1;var r={action:"lw_woo_add_new_optin_row",required:e("input#lw-woo-gdpr-new-required").is(":checked"),title:e("input#lw-woo-gdpr-new-title").val(),label:e("input#lw-woo-gdpr-new-label").val(),nonce:newNonce};jQuery.post(ajaxurl,r,function(t){if(!0!==t.success)return!1;""!==t.data.markup&&(clearNewFieldInputs(),e("table#lw-woo-gdpr-fields-table tr:last").after(t.data.markup),e(n).sortable("refreshPositions"))},"json")}}),e(r).on("click","a.lw-woo-gdpr-field-trigger-trash",function(t){t.preventDefault();var o=e(this).parents("tr.lw-woo-gdpr-field-single"),a=e(this).data("field-id"),i=e(this).data("nonce");if(""===i||void 0===i)return!1;if(""===a||void 0===a)return!1;var s={action:"lw_woo_delete_single_row",field_id:a,nonce:i};jQuery.post(ajaxurl,s,function(t){if(!0!==t.success)return!1;!0!==t.success&&"true"!==t.success||(e(r).find(o).fadeOut().remove(),e(n).sortable("refreshPositions"))},"json")}),e("form#lw-woo-gdpr-requests-admin-form").divExists(function(){e(a).on("click","a.lw-woo-action-delete",function(t){t.preventDefault();var o=e(this).parents("tr"),r=e(this).data("user-id"),n=e(this).data("nonce");if(""===n||void 0===n)return!1;if(""===r||void 0===r)return!1;var i={action:"lw_woo_process_user_delete",user_id:r,nonce:n};jQuery.post(ajaxurl,i,function(t){if(!0!==t.success)return!1;!0!==t.success&&"true"!==t.success||e(a).find(o).fadeOut().remove(),""!==t.data.message&&setAdminNotification(t.data.message),""!==t.data.ctext&&resetTableCount(t.data.ctext),!0!==t.data.remain&&window.location.reload(!0)},"json")})}),e("div.bulkactions").on("click","input.action",function(t){t.preventDefault();var o=e("#bulk-action-selector-top").val(),r=e("#bulk-action-selector-bottom").val();if("-1"!==o||"-1"!==r){"-1"!==o?o:r;var n=e("#lw_woo_gdpr_bulk_delete_nonce").val();if(""===n||void 0===n)return!1;if(i=e("input.lw-woo-user-checkbox:checked").map(function(){return e(this).val()}).get(),!jQuery.isEmptyObject(i)){var a={action:"lw_woo_process_bulk_delete",user_ids:i,nonce:n};jQuery.post(ajaxurl,a,function(e){if(s=!0!==e.success?"error":"updated",""!==e.data.message&&setAdminNotification(e.data.message,s),!0!==e.success)return!1;!0!==e.success&&"true"!==e.success||clearBulkChecks(),""!==e.data.ctext&&resetTableCount(e.data.ctext),!0!==e.data.remain&&window.location.reload(!0)},"json")}}}),e(".lw-woo-gdpr-requests-admin-wrap").on("click",".notice-dismiss",function(){e(".lw-woo-gdpr-requests-admin-wrap").find(".lw-woo-request-notice").remove()})});